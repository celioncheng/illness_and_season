<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­£ç¯€èˆ‡å¥åº·æŒ‘æˆ°è³½</title>
    <style>
        :root { --p: #0984e3; --s: #00b894; --a: #fdcb6e; --bg: #f0f3f7; }
        body { font-family: 'Microsoft JhengHei', Arial, sans-serif; background: var(--bg); padding: 20px; color: #2d3436; }
        .container { max-width: 700px; margin: auto; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: var(--p); margin-bottom: 10px; }
        
        /* æ“ä½œæé†’å€å¡Š */
        .refresh-notice {
            background: #e3f2fd;
            border: 2px dashed #2196f3;
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 25px;
            font-size: 0.95rem;
            color: #0d47a1;
        }
        .refresh-notice b { color: #1565c0; font-size: 1.1rem; }

        .section-header { 
            background: #e8f4fd; padding: 12px 20px; border-radius: 10px; 
            margin: 30px 0 15px; font-weight: bold; font-size: 1.25rem; 
            border-left: 8px solid var(--p); color: #0d47a1;
        }
        .question-card { 
            background: #fff; border: 2px solid #f0f0f0; padding: 20px; 
            margin-bottom: 15px; border-radius: 15px;
        }
        .audio-btn { 
            background: var(--a); border: none; color: #634d00; padding: 10px 20px; 
            border-radius: 50px; cursor: pointer; font-weight: bold; margin-bottom: 10px;
        }
        .hint-display { 
            font-size: 1.4rem; text-align: center; margin: 15px 0; 
            padding: 15px; background: #fffde7; border-radius: 10px; color: #d35400; font-weight: bold;
            border: 1px dashed #f39c12;
        }
        .options button { 
            display: block; width: 100%; text-align: left; margin: 8px 0; padding: 14px; 
            border: 2px solid #eee; border-radius: 12px; background: white; cursor: pointer; font-size: 1.1rem;
        }
        .options button:hover { background: #e3f2fd; border-color: var(--p); }
        .options button.selected { background: #bbdefb; border-color: var(--p); font-weight: bold; }
        .fill-container { display: flex; align-items: center; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
        .fill-input { 
            width: 35px; border: none; border-bottom: 3px solid var(--p); 
            font-size: 1.8rem; text-align: center; margin: 0 5px; background: #fffde7; outline: none;
        }
        #submit-btn { 
            width: 100%; padding: 20px; background: var(--s); color: white; 
            border: none; border-radius: 15px; font-size: 1.5rem; cursor: pointer; font-weight: bold; margin-top: 30px;
        }
        .feedback { font-weight: bold; margin-top: 10px; display: none; }
        #result-area { display: none; text-align: center; margin-top: 25px; padding: 25px; border-radius: 15px; background: #fff9db; border: 2px solid #ffd600; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸŒ± è‹±æ–‡å–®å­—æŒ‘æˆ°ï¼šå­£ç¯€èˆ‡å¥åº· ğŸŒ±</h1>
    
    <div class="refresh-notice">
        ğŸ’¡ <b>æƒ³ç·´ç¿’æ–°é¡Œç›®å—ï¼Ÿ</b><br>
        æ‰‹æ©Ÿä½¿ç”¨è€…ï¼šå°‡ç•«é¢<b>ã€Œå¾€ä¸‹æ‹‰ã€</b>æ”¾é–‹å³å¯åˆ·æ–°ã€‚<br>
        é›»è…¦ä½¿ç”¨è€…ï¼šé»æ“Šç€è¦½å™¨<b>ã€Œé‡æ–°æ•´ç†ã€</b>æŒ‰éˆ•ã€‚
    </div>

    <div id="quiz-content">æ­£åœ¨æº–å‚™é¡Œç›®ä¸­...</div>

    <button id="submit-btn" onclick="calculateScore()">äº¤å·ï¼Œçœ‹åˆ†æ•¸ï¼</button>
    <div id="result-area">
        <h2 id="score-text"></h2>
        <button onclick="location.reload()" style="padding:12px 24px; cursor:pointer; background:var(--p); color:white; border:none; border-radius:8px;">æ›´æ›é¡Œç›®é‡æ–°æ¸¬é©—</button>
    </div>
</div>

<script>
    const wordBank = [
        { en: "spring", cn: "æ˜¥å¤©", desc: "ã€èŠ±æœµç››é–‹ï¼Œå°è‰ç™¼èŠ½ã€‘" },
        { en: "summer", cn: "å¤å¤©", desc: "ã€å¤§å¤ªé™½ï¼Œè¦å»æµ·é‚Šç©æ°´ã€‘" },
        { en: "fall", cn: "ç§‹å¤©", desc: "ã€è‘‰å­è®Šé»ƒï¼Œæ‰åœ¨åœ°ä¸Šã€‘" },
        { en: "winter", cn: "å†¬å¤©", desc: "ã€å¤©æ°£å¥½å†·ï¼Œè¦ç©¿åšå¤§è¡£ã€‘" },
        { en: "weather", cn: "å¤©æ°£", desc: "ã€æœ‰æ™´å¤©ã€é›¨å¤©å’Œé›²ã€‘" },
        { en: "season", cn: "å­£ç¯€", desc: "ã€ä¸€å¹´æœ‰æ˜¥ã€å¤ã€ç§‹ã€å†¬å››å€‹...ã€‘" },
        { en: "fever", cn: "ç™¼ç‡’", desc: "ã€é¡é ­ç‡™ç‡™çš„ï¼Œèº«é«”å¾ˆä¸èˆ’æœã€‘" },
        { en: "sore throat", cn: "å–‰åš¨ç—›", desc: "ã€å–‰åš¨ç´…ç´…çš„ï¼Œåå£æ°´æœƒç—›ã€‘" },
        { en: "runny nose", cn: "æµé¼»æ°´", desc: "ã€é¼»å­ç™¢ç™¢ï¼Œä¸€ç›´æ‹¿è¡›ç”Ÿç´™æ“¦é¼»æ¶•ã€‘" },
        { en: "headache", cn: "é ­ç—›", desc: "ã€é ­æšˆæšˆç—›ç—›ï¼Œæ‰‹æŠ±è‘—é ­ã€‘" },
        { en: "stomachache", cn: "è‚šå­ç—›", desc: "ã€è‚šå­ä¸èˆ’æœï¼Œæ‰‹æ‘€è‘—è‚šå­ã€‘" },
        { en: "toothache", cn: "ç‰™ç—›", desc: "ã€ç‰™é½’è›€ç‰™äº†ï¼Œè‡‰é °è…«èµ·ä¾†ã€‘" },
        { en: "sick", cn: "ç”Ÿç—…", desc: "ã€èº«é«”ä¸å¥åº·ï¼Œèººåœ¨åºŠä¸Šä¼‘æ¯ã€‘" },
        { en: "cold", cn: "æ„Ÿå†’", desc: "ã€å’³å—½ã€æµé¼»æ¶•ï¼Œä¸èˆ’æœã€‘" }
    ];

    function speak(t) {
        const m = new SpeechSynthesisUtterance(t);
        m.lang = 'en-US';
        speechSynthesis.speak(m);
    }

    function startQuiz() {
        const container = document.getElementById('quiz-content');
        container.innerHTML = "";
        const shuffled = [...wordBank].sort(() => 0.5 - Math.random()).slice(0, 12);
        
        appendHeader(container, "ç¬¬ä¸€éƒ¨åˆ†ï¼šğŸ‘‚ è½éŸ³é¸ä¸­æ–‡ (4 é¡Œ)");
        for(let i=0; i<4; i++) renderChoice(container, shuffled[i], i, 'listening');

        appendHeader(container, "ç¬¬äºŒéƒ¨åˆ†ï¼šğŸ–¼ï¸ çœ‹æç¤ºé¸è‹±æ–‡ (4 é¡Œ)");
        for(let i=4; i<8; i++) renderChoice(container, shuffled[i], i, 'picture');

        appendHeader(container, "ç¬¬ä¸‰éƒ¨åˆ†ï¼šâœï¸ è½éŸ³æ‹¼æ‹¼çœ‹ (4 é¡Œ)");
        for(let i=8; i<12; i++) renderSpelling(container, shuffled[i], i);
    }

    function appendHeader(c, text) {
        const h = document.createElement('div');
        h.className = 'section-header';
        h.innerText = text;
        c.appendChild(h);
    }

    function renderChoice(c, item, idx, type) {
        const card = document.createElement('div');
        card.className = 'question-card';
        const isList = (type === 'listening');
        card.innerHTML = `
            <div><b>ç¬¬ ${idx+1} é¡Œ</b></div>
            ${isList ? `<button class="audio-btn" onclick="speak('${item.en}')">ğŸ”Š é»æˆ‘è½ç™¼éŸ³</button>` : `<div class="hint-display">${item.desc}</div>`}
            <p>${isList ? 'é€™å–®å­—çš„æ„æ€æ˜¯ï¼Ÿ' : 'æç¤ºå°æ‡‰å“ªå€‹è‹±æ–‡å–®å­—ï¼Ÿ'}</p>
            <div id="opts${idx}" class="options"></div>
            <p id="f${idx}" class="feedback"></p>
        `;
        card.setAttribute('data-ans', isList ? item.cn : item.en);
        c.appendChild(card);
        
        let opts = [isList ? item.cn : item.en];
        while(opts.length < 3) {
            let r = wordBank[Math.floor(Math.random()*wordBank.length)];
            let val = isList ? r.cn : r.en;
            if(!opts.includes(val)) opts.push(val);
        }
        opts.sort(() => 0.5 - Math.random()).forEach(o => {
            const b = document.createElement('button');
            b.innerText = o;
            b.onclick = function() {
                Array.from(b.parentElement.children).forEach(x => x.classList.remove('selected'));
                b.classList.add('selected');
                b.parentElement.setAttribute('data-sel', o);
            };
            document.getElementById('opts'+idx).appendChild(b);
        });
    }

    function renderSpelling(c, item, idx) {
        const card = document.createElement('div');
        card.className = 'question-card';
        let word = item.en;
        let html = '';
        
        for(let i=0; i<word.length; i++) {
            if(word[i] === ' ') {
                html += '<span style="margin: 0 10px;"> </span>';
            } else if (i === 0 || (i === word.length - 1 && word.length > 3)) {
                html += `<span>${word[i]}</span>`;
            } else {
                html += `<input type="text" class="fill-input q${idx}" data-idx="${i}" maxlength="1" oninput="if(this.value) focusNext(this, ${idx})">`;
            }
        }

        card.innerHTML = `
            <div><b>ç¬¬ ${idx+1} é¡Œ</b></div>
            <button class="audio-btn" onclick="speak('${item.en}')">ğŸ”Š è½è½çœ‹æ€éº¼æ‹¼</button>
            <p>æç¤ºï¼š${item.cn}</p>
            <div class="fill-container">${html}</div>
            <p id="f${idx}" class="feedback"></p>
        `;
        card.setAttribute('data-word', item.en);
        c.appendChild(card);
    }

    function focusNext(el, qIdx) {
        const inputs = document.querySelectorAll('.q'+qIdx);
        for(let i=0; i<inputs.length; i++){
            if(inputs[i] === el && inputs[i+1]) {
                inputs[i+1].focus();
                break;
            }
        }
    }

    function calculateScore() {
        let s = 0;
        const cards = document.querySelectorAll('.question-card');
        cards.forEach((card, i) => {
            const f = document.getElementById('f'+i);
            f.style.display = "block";
            if(card.hasAttribute('data-word')) {
                const ans = card.getAttribute('data-word').toLowerCase();
                const inputs = card.querySelectorAll('.fill-input');
                let userArr = card.getAttribute('data-word').split('');
                inputs.forEach(inp => userArr[inp.getAttribute('data-idx')] = inp.value || '_');
                if(userArr.join('').toLowerCase() === ans) { s++; f.innerText = "âœ… ç­”å°äº†ï¼"; f.style.color="green"; }
                else { f.innerText = "âŒ æ­£è§£æ˜¯: " + ans; f.style.color="red"; }
            } else {
                const optsDiv = card.querySelector('.options');
                const sel = optsDiv.getAttribute('data-sel');
                if(sel === card.getAttribute('data-ans')) { s++; f.innerText = "âœ… ç­”å°äº†ï¼"; f.style.color="green"; }
                else { f.innerText = "âŒ æ­£è§£æ˜¯: " + card.getAttribute('data-ans'); f.style.color="red"; }
            }
        });
        document.getElementById('result-area').style.display = "block";
        document.getElementById('score-text').innerText = "æ¸¬é©—å®Œæˆï¼å¾—åˆ†ï¼š" + s + " / 12";
        window.scrollTo(0, document.body.scrollHeight);
    }

    window.addEventListener('load', startQuiz);
</script>
</body>
</html>
